(this["webpackJsonpcase-ws"]=this["webpackJsonpcase-ws"]||[]).push([[0],{39:function(e,t,n){},52:function(e,t){},54:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var c,s,a,r,o,i,l,u,d,j,m=n(1),h=n.n(m),b=n(29),O=n.n(b),f=(n(39),n(2)),x=n.n(f),p=n(4),g=n(24),v=n(5),N=n(18),C=n(3),w=n(7),k=n(56),S=n(57),_=n(58),y="https://chatwskul.herokuapp.com",A=function(){var e=Object(p.a)(x.a.mark((function e(t,n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(y+t,{method:"GET",signal:n,headers:{authorization:localStorage.getItem("token")||""}}).then((function(e){return e.json()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),M=function(){var e=Object(p.a)(x.a.mark((function e(t,n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n),e.next=3,fetch(y+t,{method:"POST",headers:{"Content-Type":"application/json",authorization:localStorage.getItem("token")||""},body:JSON.stringify(n)}).then((function(e){return e.json()}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D=n(0),U=function(e){var t=e.loginSignup,n=e.setLoginSignup,c=e.usernameInput,s=e.passwordInput,a=e.theme,r=e.avatar,o=e.setResponseMessage,i=Object(v.g)(),l="login"===t?["Log in","Dont have account? ","Sign up"]:["Sign up","By singing up you agree osvosv ","terms and conditions"],u=function(){var e=Object(p.a)(x.a.mark((function e(t){var n,l,u;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/user-login","login"!==t&&(n="/create-user"),l={name:c,password:s,avatar:r[0],avatarChange:r[1],theme:a[0],themeChange:a[1]},e.next=5,M(n,l);case 5:if(!(u=e.sent).success){e.next=11;break}return localStorage.setItem("token",u.data),e.abrupt("return",i.push("/dashboard"));case 11:o(u.message);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)("section",{className:"flex center login-con-logsign-con",children:[Object(D.jsx)("button",{type:"button",className:"center login-btn",onClick:function(){return u(t)},children:l[0]}),Object(D.jsxs)("p",{className:"center login-con-noaccount",children:[l[1],Object(D.jsx)("span",{onClick:function(){"login"===t?n("signup"):console.log("terms and condition page")},children:l[2]})]})]})},R=768,I=function(e){var t=e.condition,n=e.children;return Object(D.jsx)(D.Fragment,{children:t&&n})},L=["Asset-25.png","avatar-prel.png","Asset-5.png","Asset-9.png","Asset-10.png","Asset-11.png","Asset-12.png","Asset-13.png","Asset-14.png","Asset-15.png","Asset-16.png","Asset-17.png","Asset-18.png","Asset-19.png","Asset-20.png","Asset-21.png","Asset-23.png","Asset-24.png"],E=n(8),T=Object(E.a)("div")(c||(c=Object(w.a)(["\n  background-image: url(../avatars/",");\n"])),(function(e){return e.img})),F=function(){console.log(L);var e=Object(m.useState)(window.innerWidth),t=Object(C.a)(e,2),n=t[0],c=t[1],s=Object(m.useState)("login"),a=Object(C.a)(s,2),r=a[0],o=a[1],i=Object(m.useState)([L[0],0]),l=Object(C.a)(i,2),u=l[0],d=l[1],j=Object(m.useState)(!1),h=Object(C.a)(j,2),b=h[0],O=h[1],f=Object(m.useState)([0,0]),x=Object(C.a)(f,2),p=x[0],g=x[1],v=Object(m.useState)(""),N=Object(C.a)(v,2),w=N[0],y=N[1],A=Object(m.useState)(""),M=Object(C.a)(A,2),E=M[0],F=M[1],P=Object(m.useState)(null),J=Object(C.a)(P,2),H=J[0],W=J[1];return Object(m.useEffect)((function(){var e=window.addEventListener("resize",(function(){return c(window.innerWidth)}));return window.removeEventListener("resize",e)}),[n]),Object(D.jsxs)(k.a,{className:"page page-home ".concat(n<R?"page-home-mobile":"page-home-desktop"),children:[Object(D.jsxs)(k.a,{className:"flex login-con",children:[Object(D.jsx)("h3",{children:"login"===r?"Welcome":"Create account"}),Object(D.jsx)(k.a,{className:"height100",children:Object(D.jsxs)(S.a,{className:"height100",children:[Object(D.jsx)(_.a,{lg:{span:b?5:8,order:1},md:{span:b?5:8,order:1},xs:{span:12,order:1},className:"col-nopad home-con-col1",children:Object(D.jsxs)("section",{className:"flex height100 login-con-form-btn",children:[Object(D.jsxs)("div",{className:"flex login-con-form-userpass",children:[Object(D.jsx)("label",{htmlFor:"name",children:"username:"}),Object(D.jsx)("input",{type:"text",name:"name",id:"name",placeholder:"haakon1337",onChange:function(e){return y(e.target.value)}}),Object(D.jsx)("label",{htmlFor:"password",children:"password:"}),Object(D.jsx)("input",{type:"password",name:"password",id:"password",placeholder:"pAssword123!",onChange:function(e){return F(e.target.value)}}),Object(D.jsx)("input",{type:"number",name:"theme",value:p[0],hidden:!0}),Object(D.jsx)("input",{type:"number",name:"avatar",value:u[0],hidden:!0}),Object(D.jsx)("input",{type:"number",name:"avatarChange",defaultValue:u[1],hidden:!0}),Object(D.jsx)("input",{type:"number",name:"themeChange",defaultValue:p[1],hidden:!0})]}),Object(D.jsx)(I,{condition:null!==H,children:Object(D.jsx)("div",{children:H})}),Object(D.jsx)(I,{condition:n>R,children:Object(D.jsx)(U,{loginSignup:r,setLoginSignup:o,usernameInput:w,passwordInput:E,theme:p,avatar:u,setResponseMessage:W})})]})}),Object(D.jsxs)(_.a,{lg:{span:b?3:4,order:2},md:{span:b?3:4,order:2},xs:{span:12,order:2},className:"home-con-col2 ".concat(n<R?"flex":""," col-nopad"),children:[Object(D.jsxs)(_.a,{lg:{span:12,order:1},md:{span:12,order:1},xs:{span:6,order:1},className:"login-con-avatar-con col-nopad",children:[Object(D.jsx)(T,{img:u[0],className:"chosen-avatar"}),Object(D.jsx)("button",{className:"change-avatar-btn",onClick:function(){return O(!b)},children:"change"})]}),Object(D.jsxs)(_.a,{lg:{span:12,order:2},md:{span:12,order:2},xs:{span:6,order:2},className:"login-con-theme-con col-nopad",children:[Object(D.jsx)("button",{className:"olf-theme-btn",onClick:function(){return g([0,1])},children:"olf theme"}),Object(D.jsx)("button",{className:"poke-theme-btn",onClick:function(){return g([1,1])},children:"poke theme"})]})]}),Object(D.jsx)(I,{condition:b,children:Object(D.jsx)(_.a,{lg:{span:4,order:3},md:{span:4,order:3},xs:{span:12,order:3},className:"flex col-nopad home-con-col3",children:L.map((function(e){return console.log(u[0]===e),Object(D.jsx)(T,{img:e,className:"avatars ".concat(u[0]===e?"chosen-avatar":""),onClick:function(){return d([e,1])}})}))})})]})})]}),Object(D.jsx)(I,{condition:n<R,children:Object(D.jsx)(U,{loginSignup:r,setLoginSignup:o,usernameInput:w,passwordInput:E,theme:p,avatar:u,setResponseMessage:W})})]})},P=function(e){var t=e.setNavState,n=e.navState,c=Object(v.g)();return Object(D.jsxs)("section",{className:"flex col1-nav-con",children:[Object(D.jsxs)("div",{className:"flex nav-con-li",onClick:Object(p.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t("home");case 1:case"end":return e.stop()}}),e)}))),children:[Object(D.jsx)("span",{children:Object(D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"31.827",height:"28.927",viewBox:"0 0 31.827 28.927",children:Object(D.jsx)("g",{id:"Component_3_1","data-name":"Component 3 \u2013 1",transform:"translate(1.414 1)",children:Object(D.jsxs)("g",{id:"home-outline",transform:"translate(0 0)",children:[Object(D.jsx)("path",{id:"Path_1","data-name":"Path 1",d:"M80,212v15.028a1.03,1.03,0,0,0,1.04,1.019h6.242v-8.66a1.545,1.545,0,0,1,1.56-1.528h5.2a1.545,1.545,0,0,1,1.56,1.528v8.66h6.242a1.03,1.03,0,0,0,1.04-1.019V212",transform:"translate(-76.944 -201.119)",fill:"none",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),Object(D.jsx)("path",{id:"Path_2","data-name":"Path 2",d:"M61,61.261,47.2,48.271a1.107,1.107,0,0,0-1.41,0L32,61.261",transform:"translate(-32 -48.017)",fill:"none",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),Object(D.jsx)("path",{id:"Path_3","data-name":"Path 3",d:"M355.056,71.323V64H352v4.394",transform:"translate(-331.245 -62.982)",fill:"none",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})]})})})}),Object(D.jsx)("div",{className:"nav-con-home ".concat("home"===n?"active":""),children:"HOME"})]}),Object(D.jsxs)("div",{className:"flex nav-con-li",onClick:function(){t("settings")},children:[Object(D.jsx)("span",{children:Object(D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"31.116",height:"31.834",viewBox:"0 0 31.116 31.834",children:Object(D.jsx)("g",{id:"Component_4_1","data-name":"Component 4 \u2013 1",transform:"translate(1.058 1)",children:Object(D.jsx)("g",{id:"settings-outline",children:Object(D.jsx)("path",{id:"settings-outline-2","data-name":"settings-outline",d:"M62.924,52.478a4.461,4.461,0,1,0,4,4A4.461,4.461,0,0,0,62.924,52.478Zm10.742,4.44a10.758,10.758,0,0,1-.107,1.449l3.151,2.472a.754.754,0,0,1,.171.958L73.9,66.955a.754.754,0,0,1-.916.32l-3.13-1.26a1.123,1.123,0,0,0-1.057.122,11.465,11.465,0,0,1-1.5.874,1.111,1.111,0,0,0-.615.846L66.211,71.2a.772.772,0,0,1-.744.639H59.5a.774.774,0,0,1-.745-.618l-.468-3.333a1.12,1.12,0,0,0-.627-.852,10.824,10.824,0,0,1-1.5-.876,1.115,1.115,0,0,0-1.053-.119L51.985,67.3a.754.754,0,0,1-.916-.319l-2.981-5.158a.753.753,0,0,1,.171-.958l2.663-2.091a1.119,1.119,0,0,0,.418-.981c-.025-.291-.04-.581-.04-.871s.015-.576.04-.861a1.115,1.115,0,0,0-.423-.972l-2.662-2.091a.754.754,0,0,1-.165-.954l2.981-5.158a.754.754,0,0,1,.916-.32l3.13,1.26a1.123,1.123,0,0,0,1.057-.122,11.465,11.465,0,0,1,1.5-.874,1.111,1.111,0,0,0,.615-.846l.469-3.338A.772.772,0,0,1,59.5,42h5.963a.774.774,0,0,1,.745.618l.468,3.333a1.12,1.12,0,0,0,.627.852,10.826,10.826,0,0,1,1.5.876,1.115,1.115,0,0,0,1.053.119l3.129-1.26a.754.754,0,0,1,.916.319l2.981,5.158a.753.753,0,0,1-.171.958l-2.663,2.091a1.119,1.119,0,0,0-.422.981C73.65,56.337,73.665,56.627,73.665,56.917Z",transform:"translate(-47.985 -42)",fill:"none",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})})})})}),Object(D.jsx)("div",{className:"nav-con-settings ".concat("settings"===n?"active":""),children:"SETTINGS"})]}),Object(D.jsxs)("div",{onClick:function(){localStorage.removeItem("token"),c.push("/",null)},className:"flex nav-con-li",children:[Object(D.jsx)("span",{children:Object(D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"31",height:"26.167",viewBox:"0 0 31 26.167",children:Object(D.jsxs)("g",{id:"log-out-outline",transform:"translate(1 1)",children:[Object(D.jsx)("path",{id:"Path_11","data-name":"Path 11",d:"M81.969,114.125v3.021a3.008,3.008,0,0,1-2.995,3.021H66.995A3.008,3.008,0,0,1,64,117.146V99.021A3.008,3.008,0,0,1,66.995,96h11.38c1.654,0,3.594,1.353,3.594,3.021v3.021",transform:"translate(-64 -96)",fill:"none",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),Object(D.jsx)("path",{id:"Path_12","data-name":"Path 12",d:"M368,187.979l5.99-5.99L368,176",transform:"translate(-344.99 -169.906)",fill:"none",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),Object(D.jsx)("line",{id:"Line_1","data-name":"Line 1",x2:"19",transform:"translate(8.625 12.083)",fill:"none",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})]})})}),Object(D.jsx)("div",{children:"LOG OUT"})]})]})},J=Object(E.a)("div")(s||(s=Object(w.a)(["\n  background-image: url(../avatars/",");\n"])),(function(e){return e.img})),H=function(e){var t=e.user;return Object(D.jsxs)("section",{className:"flex col1-user-con",children:[Object(D.jsx)(J,{img:t.avatar,className:"height100 user-con-avatar",children:Object(D.jsx)("div",{className:"onlinestatus-con",children:Object(D.jsx)("div",{className:"user-con-onlinestatus"})})}),Object(D.jsx)("div",{className:" flex user-con-user-name",children:t.name})]})},W=n(6),z=function(e){var t=e.ws,n=e.user,c=e.room,s=e.activeChatroom,a=e.setChatroomUpdated,r=e.setUpdateMessage,o=Object(m.useState)(!0),i=Object(C.a)(o,2),l=i[0],u=i[1],d=Object(m.useState)(null),j=Object(C.a)(d,2),h=j[0],b=j[1],O=Object(m.useState)([]),f=Object(C.a)(O,2),g=f[0],v=f[1],N=Object(m.useState)([]),w=Object(C.a)(N,2),k=w[0],S=w[1],_=Object(m.useState)([]),y=Object(C.a)(_,2),U=y[0],R=y[1],L=Object(m.useState)(null),E=Object(C.a)(L,2),T=E[0],F=E[1],P=Object(m.useState)([]),J=Object(C.a)(P,2),H=J[0],W=J[1],z=Object(m.useState)(""),B=Object(C.a)(z,2),X=B[0],G=B[1],Z=function(){var e=Object(p.a)(x.a.mark((function e(t,n){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/get-all-users",t);case 2:c=e.sent,v(c.data.filter((function(e){return n.members.includes(e._id)})).sort((function(e,t){return n.admins.includes(t._id)-n.admins.includes(e._id)}))),W(c.data.filter((function(e){return!n.members.includes(e._id)}))),R(c.data.filter((function(e){return n.admins.includes(e._id)}))),u(!1);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),K=function(){var e=Object(p.a)(x.a.mark((function e(t){var n,c,o,i,l;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],U.forEach((function(e){n.push(e._id)})),c=[],g.forEach((function(e){return c.push(e._id)})),o=null===T?s.theme:T,i=null===h?s.name:h,e.next=8,M("/protected/update-chatroom/"+t,{name:i,admins:n,members:c,theme:o});case 8:l=e.sent,a(!0),r([t,l.message]);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(p.a)(x.a.mark((function e(n,c){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/delete-chatroom/"+c,n);case 2:e.sent,a(!0),t.send(JSON.stringify({type:"chatroomDelete",detail:"chatroomDelete",chatroomId:c}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Y=function(){var e=Object(p.a)(x.a.mark((function e(c,s){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M("/protected/leave-chatroom/"+s+"/"+n._id,c);case 2:e.sent,a(!0),t.send(JSON.stringify({type:"chatroomUpdate",detail:"userLeft",chatroomId:s,user:n}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new AbortController,!s){e.next=4;break}return e.next=4,Z(t.signal,s);case 4:return e.abrupt("return",(function(){return t.abort()}));case 5:case"end":return e.stop()}}),e)}))),[s]),l?Object(D.jsx)("h2",{className:"",children:"Loading..."}):Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(I,{condition:c.admins.includes(n._id),children:Object(D.jsx)(V,{user:n,room:c,roomAdmins:U,setRoomAdmins:R,roomName:h,setRoomName:b,roomMembers:g,setRoomMembers:v,notRoomMembers:H,setNotRoomMembers:W,roomTheme:T,setRoomTheme:F,searchUsersInput:X,setSearchUsersInput:G,fetchDeleteChatroom:Q,fetchUpdateChatroom:K})}),Object(D.jsx)(I,{condition:!c.admins.includes(n._id),children:Object(D.jsx)(q,{user:n,room:c,roomAdmins:U,roomName:h,roomMembers:g,setRoomMembers:v,notRoomMembers:H,setNotRoomMembers:W,roomTheme:T,setRoomTheme:F,searchUsersInput:X,setSearchUsersInput:G,fetchLeaveChatroom:Y,fetchUpdateChatroom:K,newRoomMembers:k,setNewRoomMembers:S})})]})},q=function(e){var t=e.room,n=e.roomAdmins,c=e.roomMembers,s=e.setRoomMembers,a=e.notRoomMembers,r=e.setNotRoomMembers,o=e.roomTheme,i=e.setRoomTheme,l=e.searchUsersInput,u=e.setSearchUsersInput,d=e.fetchLeaveChatroom,j=e.fetchUpdateChatroom,m=e.newRoomMembers,h=e.setNewRoomMembers;return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)("p",{className:"chat-settings-members",children:[t.members.length," members"]}),Object(D.jsx)("div",{className:"chat-settings-text",children:"Members:"}),Object(D.jsx)("div",{className:"flex chat-settings-members-container",children:c.map((function(e,t){return Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{className:"flex chat-settings-current-members",children:[Object(D.jsx)("div",{className:"current-members",children:e.name}),Object(D.jsx)(I,{condition:n.includes(e),children:Object(D.jsx)("span",{children:"A"})})]}),Object(D.jsx)(I,{condition:m.includes(e),children:Object(D.jsx)("div",{className:"chat-settings-kick",onClick:function(){var t=c.filter((function(t){return t._id!==e._id}));s(t);var n=a;n.includes(e)||n.push(e),r(n);var o=m.filter((function(t){return t._id!==e._id}));h(o)},children:"X"})})]})}))}),Object(D.jsxs)("div",{className:"flex",children:[Object(D.jsx)("label",{className:"chat-settings-text",children:"add members:"}),Object(D.jsx)("input",{className:"chat-settings-input-text",type:"text",placeholder:"search user",value:l,onChange:function(e){return u(e.target.value)}})]}),Object(D.jsx)("div",{className:"flex chat-settings-addable-members",children:Object(D.jsx)(I,{condition:""!==l,children:a.map((function(e){return Object(D.jsx)(I,{condition:void 0!==e,children:Object(D.jsx)(I,{condition:e.name.includes(l)&&!c.includes(e),children:Object(D.jsx)("span",{className:"chat-settings-add-member-user",onClick:function(){s((function(t){return[].concat(Object(W.a)(t),[e])})),h((function(t){return[].concat(Object(W.a)(t),[e])}))},children:e.name})})})}))})}),Object(D.jsx)("hr",{}),Object(D.jsx)("div",{className:"chat-settings-text",children:"color:"}),Object(D.jsxs)("div",{className:"flex chat-settings-default-colors",children:[Object(D.jsx)("div",{className:"settings-con-green ".concat("#A2DC68"===o?"chosen-color":""),onClick:function(){return i("#A2DC68")}}),Object(D.jsx)("div",{className:"settings-con-blue ".concat("#68DCC4"===o?"chosen-color":""),onClick:function(){return i("#68DCC4")}}),Object(D.jsx)("div",{className:"settings-con-purple ".concat("#DC68D0"===o?"chosen-color":""),onClick:function(){return i("#DC68D0")}}),Object(D.jsx)("div",{className:"settings-con-yellow ".concat("#D8DC68"===o?"chosen-color":""),onClick:function(){return i("#D8DC68")}})]}),Object(D.jsxs)("div",{className:"flex chat-settings-color-pick",children:[Object(D.jsx)("div",{className:"chat-settings-text",children:"pick:"}),Object(D.jsx)("input",{className:"chat-settings-color-picker",type:"color",onChange:function(e){return i(e.target.value)}})]}),Object(D.jsx)("hr",{}),Object(D.jsxs)("div",{className:"chat-settings-delete",onClick:Object(p.a)(x.a.mark((function e(){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new AbortController,e.next=3,d(n.signal,t._id);case 3:return e.abrupt("return",(function(){return n.abort()}));case 4:case"end":return e.stop()}}),e)}))),children:[Object(D.jsx)("span",{children:"X"})," Leave chatroom"]}),Object(D.jsx)("div",{className:"chat-settings-save",onClick:function(){return j(t._id)},children:"SAVE"})]})},V=function(e){var t=e.user,n=e.room,c=e.roomAdmins,s=e.setRoomAdmins,a=e.setRoomName,r=e.roomMembers,o=e.setRoomMembers,i=e.notRoomMembers,l=e.setNotRoomMembers,u=e.roomTheme,d=e.setRoomTheme,j=e.searchUsersInput,m=e.setSearchUsersInput,h=e.fetchDeleteChatroom,b=e.fetchUpdateChatroom;return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)("p",{className:"chat-settings-members",children:[n.members.length," members"]}),Object(D.jsx)("label",{className:"chat-settings-text",children:"Change name:"}),Object(D.jsx)("input",{className:"chat-settings-input-text",type:"text",placeholder:n.name,onChange:function(e){return a(e.target.value)}}),Object(D.jsx)("div",{className:"chat-settings-text",children:"Members:"}),Object(D.jsx)("div",{className:"flex chat-settings-members-container",children:r.map((function(e,n){return Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{className:"flex chat-settings-current-members",children:[Object(D.jsxs)("div",{className:"current-members",children:[e.name," "]}),Object(D.jsx)(I,{condition:c.includes(e),children:Object(D.jsx)("span",{children:"A"})})]}),Object(D.jsxs)(I,{condition:e._id!==t._id,children:[Object(D.jsx)(I,{condition:!c.includes(e),children:Object(D.jsx)("div",{className:"chat-settings-make-admin",onClick:function(){return s((function(t){return[].concat(Object(W.a)(t),[e])}))},children:"adminize"})}),Object(D.jsx)(I,{condition:!c.includes(e),children:Object(D.jsx)("div",{className:"chat-settings-kick",onClick:function(){var t=r.filter((function(t){return t._id!==e._id}));o(t);var n=i;n.includes(e)||n.push(e),l(n)},children:"kick"})})]})]})}))}),Object(D.jsxs)("div",{className:"flex",children:[Object(D.jsx)("label",{className:"chat-settings-text",children:"Add member:"}),Object(D.jsx)("input",{className:"chat-settings-input-text",type:"text",placeholder:"search member",value:j,onChange:function(e){return m(e.target.value)}})]}),Object(D.jsx)("div",{className:"flex chat-settings-addable-members",children:Object(D.jsx)(I,{condition:""!==j,children:i.map((function(e){return Object(D.jsx)(I,{condition:void 0!==e,children:Object(D.jsx)(I,{condition:e.name.includes(j)&&!r.includes(e),children:Object(D.jsx)("span",{className:"chat-settings-add-member-user",onClick:function(){return o((function(t){return[].concat(Object(W.a)(t),[e])}))},children:e.name})})})}))})}),Object(D.jsx)("hr",{}),Object(D.jsx)("div",{className:"chat-settings-text",children:"Color:"}),Object(D.jsxs)("div",{className:"flex chat-settings-default-colors",children:[Object(D.jsx)("div",{className:"settings-con-green ".concat("#A2DC68"===u?"chosen-color":""),onClick:function(){return d("#A2DC68")}}),Object(D.jsx)("div",{className:"settings-con-blue ".concat("#68DCC4"===u?"chosen-color":""),onClick:function(){return d("#68DCC4")}}),Object(D.jsx)("div",{className:"settings-con-purple ".concat("#DC68D0"===u?"chosen-color":""),onClick:function(){return d("#DC68D0")}}),Object(D.jsx)("div",{className:"settings-con-yellow ".concat("#D8DC68"===u?"chosen-color":""),onClick:function(){return d("#D8DC68")}})]}),Object(D.jsxs)("div",{className:"flex chat-settings-color-pick",children:[Object(D.jsx)("div",{className:"chat-settings-text",children:"Pick your own:"}),Object(D.jsx)("input",{className:"chat-settings-color-picker",type:"color",onChange:function(e){e.target.classList.add("chosen-color"),d(e.target.value)}})]}),Object(D.jsx)("hr",{}),Object(D.jsxs)("div",{className:"chat-settings-delete",onClick:Object(p.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new AbortController,e.next=3,h(t.signal,n._id);case 3:return e.abrupt("return",(function(){return t.abort()}));case 4:case"end":return e.stop()}}),e)}))),children:[Object(D.jsx)("span",{children:"X"})," Delete chatroom"]}),Object(D.jsx)("div",{className:"chat-settings-save",onClick:function(){return b(n._id)},children:"SAVE"})]})},B=Object(E.a)("section")(a||(a=Object(w.a)(["\n  background: linear-gradient(\n    235deg,\n    "," 25%,\n    rgba(255, 255, 255, 1) 25%\n  );\n"])),(function(e){return e.theme})),X=function(e){var t=e.ws,n=e.user,c=e.userChatrooms,s=e.setChatroomUpdated,a=(e.avatarSwitch,e.setAvatarSwitch),r=Object(m.useState)(null),o=Object(C.a)(r,2),i=o[0],l=o[1],u=Object(m.useState)(""),d=Object(C.a)(u,2),j=d[0],h=d[1],b=Object(m.useState)([null,null]),O=Object(C.a)(b,2),f=O[0],x=O[1];return Object(m.useEffect)((function(){f[0]&&setTimeout((function(){return x([null,null])}),4e3)}),[f]),Object(m.useEffect)((function(){i&&a(!1)}),[i]),Object(D.jsxs)("section",{className:"flex height100 dash-settings-chatrooms",children:[Object(D.jsx)("section",{className:"flex search-chatroom-con",children:Object(D.jsx)("input",{type:"text",placeholder:"search chatrooms",onInput:function(e){return h(e.target.value)}})}),Object(D.jsx)("section",{className:"flex height100 settings-chatrooms-con",children:c.map((function(e){return Object(D.jsx)(I,{condition:e.name.includes(j),children:Object(D.jsxs)(B,{theme:e.theme,className:"col2-chatroom-con ".concat(i===e?"active":""),onClick:function(){l(e)},children:[Object(D.jsxs)("h5",{className:"flex",children:[e.name,Object(D.jsx)(I,{condition:e.admins.includes(n._id),children:Object(D.jsx)("span",{children:"A"})})]}),Object(D.jsx)(I,{condition:f,children:Object(D.jsx)(I,{condition:f[0]===e._id,children:Object(D.jsxs)("div",{children:[f[1]," ",Object(D.jsx)("i",{className:"fas fa-check"})]})})}),Object(D.jsx)(I,{condition:e===i,children:Object(D.jsx)(z,{ws:t,user:n,room:e,activeChatroom:i,setChatroomUpdated:s,setUpdateMessage:x})})]})})}))})]})},G=Object(E.a)("div")(r||(r=Object(w.a)(["\n  background-image: url(../avatars/",");\n"])),(function(e){return e.img})),Z=function(e){var t=e.user,n=e.setUserUpdated,c=e.avatarSwitch,s=e.setAvatarSwitch,a=Object(m.useState)([t.avatar,0]),r=Object(C.a)(a,2),o=r[0],i=r[1],l=Object(m.useState)(t.theme),u=Object(C.a)(l,2),d=u[0],j=u[1],h=Object(m.useState)(t.name),b=Object(C.a)(h,2),O=b[0],f=b[1],g=Object(m.useState)(""),v=Object(C.a)(g,2),N=v[0],w=v[1],k=Object(m.useState)(""),S=Object(C.a)(k,2),_=S[0],y=S[1],A=Object(m.useState)(null),U=Object(C.a)(A,2),R=U[0],E=U[1],T=function(){var e=Object(p.a)(x.a.mark((function e(){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M("/protected/update-user/".concat(t._id),{name:O,newPassword:N,currentPassword:_,avatar:o[0],avatarChange:o[1],theme:d});case 2:c=e.sent,n(!0),s(!1),E(c.message);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(m.useEffect)((function(){R&&setTimeout((function(){return E(null)}),4e3)}),[R]),Object(D.jsxs)("div",{className:"height100 col3-settings-con",children:[Object(D.jsxs)("div",{className:"user-settings-input-con",children:[Object(D.jsx)("label",{className:"user-settings-text",htmlFor:"name",children:"Name:"}),Object(D.jsx)("input",{className:"user-settings-input",type:"text",name:"name",placeholder:O,onChange:function(e){return f(e.target.value)}})]}),Object(D.jsxs)("div",{className:"user-settings-input-con",children:[Object(D.jsx)("label",{className:"user-settings-text",htmlFor:"newPassword",children:"New password:"}),Object(D.jsx)("input",{className:"user-settings-input",type:"password",name:"newPassword",onChange:function(e){return w(e.target.value)}})]}),Object(D.jsxs)("div",{className:"user-settings-input-con",children:[Object(D.jsx)("label",{className:"user-settings-text",htmlFor:"password",children:"Current password:"}),Object(D.jsx)("input",{className:"user-settings-input",type:"password",name:"password",onChange:function(e){return y(e.target.value)}})]}),Object(D.jsxs)("div",{className:"flex user-settings-input-con",children:[Object(D.jsx)("label",{className:"user-settings-text",htmlFor:"theme",children:"Theme:"}),Object(D.jsxs)("div",{className:"flex user-settings-themes",children:[Object(D.jsx)("div",{className:"user-settings-theme-1",onClick:function(){return j(0)}}),Object(D.jsx)("div",{className:"user-settings-theme-2",onClick:function(){return j(1)}})]})]}),Object(D.jsxs)("div",{className:"flex user-settings-input-con",children:[Object(D.jsx)("label",{className:"user-settings-text",htmlFor:"avatar",children:"Avatar:"}),Object(D.jsx)(G,{img:o[0],className:"chosen-avatar"}),Object(D.jsxs)("button",{className:"change-avatar-button",onClick:function(){return s(!c)},children:["Change"," ",Object(D.jsx)(I,{condition:!c,children:Object(D.jsx)("i",{class:"fas fa-caret-down"})}),Object(D.jsx)(I,{condition:c,children:Object(D.jsx)("i",{class:"fas fa-caret-up"})})]})]}),Object(D.jsx)(I,{condition:c,children:Object(D.jsx)("div",{className:"flex avatars-con",children:L.map((function(e){return Object(D.jsx)(G,{img:e,className:"avatars ".concat(e===o[0]?"current-avatar":""),onClick:function(){return i([e,1])}})}))})}),Object(D.jsx)("div",{className:"flex user-settings-save-con",children:Object(D.jsx)("button",{className:"user-settings-save-button",onClick:function(){return T()},children:"SAVE"})}),Object(D.jsx)(I,{condition:R,children:Object(D.jsxs)("div",{children:[R," ",Object(D.jsx)("i",{className:"fas fa-check"})]})})]})},K=function(e){var t=e.ws,n=e.user,c=e.setUserUpdated,s=e.userChatrooms,a=e.setChatroomUpdated,r=Object(m.useState)(window.innerWidth),o=Object(C.a)(r,2),i=o[0],l=o[1],u=Object(m.useState)(!1),d=Object(C.a)(u,2),j=d[0],h=d[1];return Object(m.useEffect)((function(){var e=window.addEventListener("resize",(function(){return l(window.innerWidth)}));return window.removeEventListener("resize",e)}),[i]),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(_.a,{lg:{span:j?4:6,order:2},md:{span:6,order:2},xs:{span:12,order:2},className:"dashboard-con-col2",children:Object(D.jsx)(X,{ws:t,user:n,userChatrooms:s,setChatroomUpdated:a,avatarSwitch:j,setAvatarSwitch:h})}),Object(D.jsx)(_.a,{lg:{span:j?6:4,order:3},md:{span:4,order:3},xs:{span:12,order:3},className:"dashboard-con-col3",children:Object(D.jsx)(Z,{user:n,setUserUpdated:c,avatarSwitch:j,setAvatarSwitch:h})})]})},Q=Object(E.a)("section")(o||(o=Object(w.a)(["\n  background: linear-gradient(\n    235deg,\n    "," 25%,\n    rgba(255, 255, 255, 1) 25%\n  );\n"])),(function(e){return e.theme})),Y=Object(E.a)("div")(i||(i=Object(w.a)(["\n  background-image: url(../avatars/",");\n"])),(function(e){return e.img})),$=Object(E.a)("span")(l||(l=Object(w.a)(["\n  background-color: ",";\n"])),(function(e){return e.color})),ee=function(e){var t=e.ws,n=e.user,c=e.userChatrooms,s=e.notUserChatrooms,a=e.activeChatroom,r=e.setActiveChatroom,o=e.setHomeCol3State,i=e.chatroomLastMessage,l=e.chatroomUnreadMsgs,u=e.setChatroomUpdated,d=e.usersOnline,j=e.setMobileCol2Chatrooms,h=Object(m.useState)(""),b=Object(C.a)(h,2),O=b[0],f=b[1],g=Object(m.useState)(!1),v=Object(C.a)(g,2),N=v[0],w=v[1],k=Object(m.useState)(!1),S=Object(C.a)(k,2),_=S[0],y=S[1],M=function(){var e=Object(p.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/delete-all-chatrooms",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(p.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/delete-all-messages",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.useEffect)((function(){document.querySelector(".dash-home-chatrooms").style.height="calc(100% - 5rem - ".concat(document.querySelector(".dash-home-usersonline").offsetHeight,"px)")}),[_]),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)("section",{className:"flex search-chatroom-con",children:[Object(D.jsx)("input",{type:"text",placeholder:N?"search other chatrooms":"search your chatrooms",onInput:function(e){return f(e.target.value)}}),Object(D.jsxs)("div",{className:"flex",children:[Object(D.jsx)("label",{children:"other"}),Object(D.jsx)("input",{type:"checkbox",onChange:function(e){return w(e.target.checked)}})]})]}),Object(D.jsxs)("section",{className:"dash-home-usersonline",children:[Object(D.jsxs)("div",{onClick:function(){y(!_)},children:[Object(D.jsx)("i",{class:"fas fa-users"})," Users online (",d.length,")"," ",Object(D.jsx)(I,{condition:!_,children:Object(D.jsx)("i",{class:"fas fa-caret-down"})}),Object(D.jsx)(I,{condition:_,children:Object(D.jsx)("i",{class:"fas fa-caret-up"})})]}),Object(D.jsx)(I,{condition:_,children:d.map((function(e){return Object(D.jsxs)("div",{className:"flex users-online-container",children:[Object(D.jsx)(Y,{img:e.avatar,className:"con-online-avatar"}),Object(D.jsx)("div",{className:"con-online-username",children:e.name})]})}))})]}),Object(D.jsxs)("section",{className:"flex dash-home-chatrooms",children:[Object(D.jsx)("button",{onClick:function(){var e=new AbortController;return M(e.signal),function(){return e.abort()}},children:"delete chatrooms"}),Object(D.jsx)("button",{onClick:function(){var e=new AbortController;return U(e.signal),function(){return e.abort()}},children:"delete msgs"}),Object(D.jsxs)("div",{className:"flex home-chatrooms-con",children:[Object(D.jsx)(I,{condition:!N,children:c.map((function(e){return Object(D.jsx)(I,{condition:e.name.includes(O),children:Object(D.jsx)(te,{joinable:!1,room:e,user:n,activeChatroom:a,setActiveChatroom:r,setHomeCol3State:o,chatroomLastMessage:i,chatroomUnreadMsgs:l,ws:t,setMobileCol2Chatrooms:j,usersOnline:d})})}))}),Object(D.jsx)(I,{condition:N,children:s.map((function(e){return Object(D.jsx)(I,{condition:e.name.includes(O),children:Object(D.jsx)(te,{joinable:!0,room:e,user:n,ws:t,setChatroomUpdated:u})})}))})]})]}),Object(D.jsxs)("div",{className:"create-con",children:[Object(D.jsx)("i",{class:"fas fa-plus"})," ",Object(D.jsx)("button",{onClick:function(){o("createChatroom"),j(!1),r(!1)},children:"create new chatroom"})]})]})},te=function(e){var t=e.joinable,n=e.room,c=e.activeChatroom,s=e.setActiveChatroom,a=e.user,r=e.setHomeCol3State,o=e.chatroomLastMessage,i=e.chatroomUnreadMsgs,l=e.setChatroomUpdated,u=e.ws,d=e.setMobileCol2Chatrooms,j=e.usersOnline,h=Object(m.useState)(!0),b=Object(C.a)(h,2),O=(b[0],b[1]),f=Object(m.useState)(!1),g=Object(C.a)(f,2),v=g[0],N=g[1],w=Object(m.useState)(0),k=Object(C.a)(w,2),S=k[0],_=k[1],y=Object(m.useState)(!1),U=Object(C.a)(y,2),R=U[0],L=U[1],E=function(){var e=Object(p.a)(x.a.mark((function e(t){var s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("lol"),e.next=3,A("/protected/get-chatroom-last-message/".concat(n._id),t);case 3:if(s=e.sent,N(s.data),n===c){e.next=9;break}return e.abrupt("return",P(t));case 9:O(!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(p.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M("/protected/starmark-chatroom/".concat(n._id,"/").concat(a._id));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(p.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M("/protected/update-chatroom-unread",{chatroomId:n._id,userId:a._id,nollify:c._id===n._id});case 2:t=e.sent,console.log(t),_(t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(p.a)(x.a.mark((function e(t){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/get-chatroom-unread/".concat(a._id,"/").concat(n._id),t);case 2:c=e.sent,_(c.data.unread),O(!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(p.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M("/protected/join-chatroom",{chatroomId:n._id,userId:a._id});case 2:e.sent,u.send(JSON.stringify({type:"chatroomUpdate",detail:"userJoined",chatroomId:n._id,user:a})),l(!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=5;break}return n=new AbortController,e.next=4,E(n.signal);case 4:return e.abrupt("return",(function(){return n.abort()}));case 5:case"end":return e.stop()}}),e)}))),[]),Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=6;break}if(t||o.chatroom!==n._id){e.next=6;break}return c=new AbortController,e.next=5,E(c.signal);case 5:return e.abrupt("return",(function(){return c.abort()}));case 6:case"end":return e.stop()}}),e)}))),[o]),Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i&&!R){e.next=6;break}if(!(!t&&R||!t&&i.chatroom===n._id)){e.next=6;break}return c=new AbortController,e.next=5,F(c.signal);case 5:return e.abrupt("return",(function(){return c.abort()}));case 6:case"end":return e.stop()}}),e)}))),[i,R]),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(I,{condition:!t,children:Object(D.jsxs)(Q,{theme:n.theme,className:"col2-chatroom-con ".concat(c===n?"active":""),onClick:Object(p.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(n),r("chat"),d(!1),S>0&&L(!0);case 4:case"end":return e.stop()}}),e)}))),children:[Object(D.jsxs)("div",{className:"flex chatroom-con-title-fav-con",children:[Object(D.jsx)("div",{className:"flex fav-con-name-admin",children:Object(D.jsxs)("div",{className:"flex",children:[Object(D.jsx)("h5",{children:n.name}),Object(D.jsx)(I,{condition:n.admins.includes(a._id),children:Object(D.jsx)("div",{className:"fav-con-admin-icon",children:"A"})})]})}),Object(D.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:Object(D.jsx)("path",{className:"".concat(n.starmarked.includes(a._id)?"starmarked":""," title-fav-con-fav"),onClick:function(e){e.target.classList.toggle("starmarked"),T()},d:"M12 .587l3.668 7.568 8.332 1.151-6.064 5.828 1.48 8.279-7.416-3.967-7.417 3.967 1.481-8.279-6.064-5.828 8.332-1.151z"})})]}),v?Object(D.jsxs)("div",{className:"flex chatroom-con-mes",children:[Object(D.jsx)(Y,{img:v.user.avatar,className:"con-mes-avatar",children:Object(D.jsx)("div",{className:"onlinestatus-con",children:Object(D.jsx)($,{color:j.filter((function(e){return e._id===v.user._id})).length>0?"#A2DC68":"#FF997D",className:"user-con-onlinestatus"})})}),Object(D.jsxs)("div",{children:[Object(D.jsx)("div",{className:"con-mes-message",children:v.message.text}),Object(D.jsx)("div",{className:"con-mes-message-time",children:v.message.time})]})]}):Object(D.jsx)("div",{className:"con-mes-no-message",children:"no messages"}),console.log(S,"ahahhahah"),Object(D.jsx)(I,{condition:S>0,children:Object(D.jsx)("div",{className:"new-message-container",children:Object(D.jsx)("div",{className:"new-messages-icon",children:S})})})]})}),Object(D.jsx)(I,{condition:t,children:Object(D.jsxs)(Q,{className:"col2-chatroom-con",theme:n.theme,children:[Object(D.jsx)("div",{className:"flex chatroom-con-title-fav-con",children:Object(D.jsx)("h5",{children:n.name})}),Object(D.jsx)("button",{onClick:function(){return J()},children:"JOIN"})]})})]})},ne=function(){var e=(new Date).toLocaleDateString().split("-"),t=e[0].at(-2)+e[0].at(-1);if(0===e[1].at(0)&&0===e[2].at(0)){var n=e[2],c=e[1];e="".concat(n[1],"/").concat(c[1])}else if(0===e[1].at(0)){var s=e[1];e="".concat(e[2],"/").concat(s[1])}else if(0===e[2].at(0)){var a=e[2];e="".concat(a[1],"/").concat(e[1])}else e="".concat(e[2],"/").concat(e[1]);var r=(new Date).toLocaleTimeString().split(":");return e+"-"+t+" "+(r[0]+":"+r[1])},ce=function(e){var t=e.ws,n=e.user,c=e.room,s=e.activeChatroom,a=e.setActiveChatroom,r=e.setChatroomUpdated,o=e.setChatState,i=e.setHomeCol3State,l=Object(m.useState)(!0),u=Object(C.a)(l,2),d=u[0],j=u[1],h=Object(m.useState)(null),b=Object(C.a)(h,2),O=b[0],f=b[1],g=Object(m.useState)([]),v=Object(C.a)(g,2),N=v[0],w=v[1],k=Object(m.useState)([]),S=Object(C.a)(k,2),_=S[0],y=S[1],U=Object(m.useState)(null),R=Object(C.a)(U,2),L=R[0],E=R[1],T=Object(m.useState)([]),F=Object(C.a)(T,2),P=F[0],J=F[1],H=Object(m.useState)(""),W=Object(C.a)(H,2),z=W[0],q=W[1],V=function(){var e=Object(p.a)(x.a.mark((function e(t,n){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/get-all-users",t);case 2:c=e.sent,w(c.data.filter((function(e){return n.members.includes(e._id)})).sort((function(e,t){return n.admins.includes(t._id)-n.admins.includes(e._id)}))),J(c.data.filter((function(e){return!n.members.includes(e._id)}))),y(c.data.filter((function(e){return n.admins.includes(e._id)}))),j(!1);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),B=function(){var e=Object(p.a)(x.a.mark((function e(t){var n,c,i,l,u;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],_.forEach((function(e){n.push(e._id)})),c=[],N.forEach((function(e){return c.push(e._id)})),i=null===L?s.theme:L,l=null===O?s.name:O,e.next=8,M("/protected/update-chatroom/"+t,{name:l,admins:n,members:c,theme:i});case 8:u=e.sent,r(!0),o(!0),a(u.data);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(p.a)(x.a.mark((function e(n,c){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/delete-chatroom/"+c,n);case 2:e.sent,r(!0),i("createChatroom"),a(!1),t.send(JSON.stringify({type:"chatroomDelete",detail:"chatroomDelete",chatroomId:c}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),G=function(){var e=Object(p.a)(x.a.mark((function e(c,s){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M("/protected/leave-chatroom/"+s+"/"+n._id,c);case 2:e.sent,r(!0),i("createChatroom"),a(!1),t.send(JSON.stringify({type:"chatroomUpdate",detail:"userLeft",chatroomId:s,user:n}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new AbortController,!s){e.next=4;break}return e.next=4,V(t.signal,s);case 4:return e.abrupt("return",(function(){return t.abort()}));case 5:case"end":return e.stop()}}),e)}))),[s]),d?Object(D.jsx)("h2",{className:"",children:"Loading..."}):Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(I,{condition:c.admins.includes(n._id),children:Object(D.jsx)(ae,{user:n,room:c,roomAdmins:_,setRoomAdmins:y,roomName:O,setRoomName:f,roomMembers:N,setRoomMembers:w,notRoomMembers:P,setNotRoomMembers:J,roomTheme:L,setRoomTheme:E,searchUsersInput:z,setSearchUsersInput:q,fetchDeleteChatroom:X,fetchUpdateChatroom:B})}),Object(D.jsx)(I,{condition:!c.admins.includes(n._id),children:Object(D.jsx)(se,{user:n,room:c,roomAdmins:_,roomName:O,roomMembers:N,setRoomMembers:w,notRoomMembers:P,setNotRoomMembers:J,roomTheme:L,setRoomTheme:E,searchUsersInput:z,setSearchUsersInput:q,fetchLeaveChatroom:G,fetchUpdateChatroom:B})})]})},se=function(e){var t=e.room,n=e.roomAdmins,c=e.roomMembers,s=e.setRoomMembers,a=e.notRoomMembers,r=(e.setNotRoomMembers,e.roomTheme),o=e.setRoomTheme,i=e.searchUsersInput,l=e.setSearchUsersInput,u=e.fetchLeaveChatroom,d=e.fetchUpdateChatroom;return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)("p",{className:"chat-settings-members",children:[t.members.length," members"]}),Object(D.jsx)("div",{className:"chat-settings-text",children:"Members:"}),Object(D.jsx)("div",{className:"flex chat-settings-members-container",children:c.map((function(e,t){return Object(D.jsx)("div",{children:Object(D.jsxs)("div",{className:"flex chat-settings-current-members",children:[Object(D.jsx)("div",{className:"current-members",children:e.name}),Object(D.jsx)(I,{condition:n.includes(e),children:Object(D.jsx)("span",{children:"A"})})]})})}))}),Object(D.jsxs)("div",{className:"flex",children:[Object(D.jsx)("label",{className:"chat-settings-text",children:"add members:"}),Object(D.jsx)("input",{className:"chat-settings-input-text",type:"text",placeholder:"search user",value:i,onChange:function(e){return l(e.target.value)}})]}),Object(D.jsx)("div",{children:Object(D.jsx)(I,{condition:""!==i,children:a.map((function(e){return Object(D.jsx)(I,{condition:void 0!==e,children:Object(D.jsx)(I,{condition:e.name.includes(i)&&!c.includes(e),children:Object(D.jsx)("span",{className:"chat-settings-add-member-user",onClick:function(){return s((function(t){return[].concat(Object(W.a)(t),[e])}))},children:e.name})})})}))})}),Object(D.jsx)("hr",{}),Object(D.jsx)("div",{className:"chat-settings-text",children:"Color:"}),Object(D.jsxs)("div",{className:"flex chat-settings-default-colors",children:[Object(D.jsx)("div",{className:"settings-con-green ".concat("#A2DC68"===r?"chosen-color":""),onClick:function(){return o("#A2DC68")}}),Object(D.jsx)("div",{className:"settings-con-blue ".concat("#68DCC4"===r?"chosen-color":""),onClick:function(){return o("#68DCC4")}}),Object(D.jsx)("div",{className:"settings-con-purple ".concat("#DC68D0"===r?"chosen-color":""),onClick:function(){return o("#DC68D0")}}),Object(D.jsx)("div",{className:"settings-con-yellow ".concat("#D8DC68"===r?"chosen-color":""),onClick:function(){return o("#D8DC68")}})]}),Object(D.jsxs)("div",{className:"flex chat-settings-color-pick",children:[Object(D.jsx)("div",{className:"chat-settings-text",children:"Pick your own:"}),Object(D.jsx)("input",{className:"chat-settings-color-picker",type:"color",onChange:function(e){return o(e.target.value)}})]}),Object(D.jsx)("hr",{}),Object(D.jsxs)("div",{className:"chat-settings-delete",onClick:Object(p.a)(x.a.mark((function e(){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new AbortController,e.next=3,u(n.signal,t._id);case 3:return e.abrupt("return",(function(){return n.abort()}));case 4:case"end":return e.stop()}}),e)}))),children:[Object(D.jsx)("span",{children:"X"})," Leave chatroom"]}),Object(D.jsx)("div",{className:"chat-settings-save",onClick:function(){return d(t._id)},children:"SAVE"})]})},ae=function(e){var t=e.user,n=e.room,c=e.roomAdmins,s=e.setRoomAdmins,a=e.setRoomName,r=e.roomMembers,o=e.setRoomMembers,i=e.notRoomMembers,l=e.setNotRoomMembers,u=e.roomTheme,d=e.setRoomTheme,j=e.searchUsersInput,m=e.setSearchUsersInput,h=e.fetchDeleteChatroom,b=e.fetchUpdateChatroom;return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)("p",{className:"chat-settings-members",children:[n.members.length," members"]}),Object(D.jsxs)("div",{className:"flex",children:[Object(D.jsx)("label",{className:"chat-settings-text",children:"Change name:"}),Object(D.jsx)("input",{className:"chat-settings-input-text",type:"text",placeholder:n.name,onChange:function(e){return a(e.target.value)}})]}),Object(D.jsx)("div",{className:"chat-settings-text",children:"Members:"}),Object(D.jsx)("div",{className:"flex chat-settings-members-container",children:r.map((function(e,n){return Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{className:"flex chat-settings-current-members",children:[Object(D.jsxs)("div",{className:"current-members",children:[e.name," "]}),Object(D.jsx)(I,{condition:c.includes(e),children:Object(D.jsx)("span",{children:"A"})})]}),Object(D.jsxs)(I,{condition:e._id!==t._id,children:[Object(D.jsx)(I,{condition:!c.includes(e),children:Object(D.jsx)("div",{className:"chat-settings-make-admin",onClick:function(){return s((function(t){return[].concat(Object(W.a)(t),[e])}))},children:"adminize"})}),Object(D.jsx)(I,{condition:!c.includes(e),children:Object(D.jsx)("div",{className:"chat-settings-kick",onClick:function(){var t=r.filter((function(t){return t._id!==e._id}));o(t);var n=i;n.includes(e)||n.push(e),l(n)},children:"kick"})})]})]})}))}),Object(D.jsxs)("div",{className:"flex",children:[Object(D.jsx)("label",{className:"chat-settings-text",children:"Add member:"}),Object(D.jsx)("input",{className:"chat-settings-input-text",type:"text",placeholder:"search member",value:j,onChange:function(e){return m(e.target.value)}})]}),Object(D.jsx)("div",{children:Object(D.jsx)(I,{condition:""!==j,children:i.map((function(e){return Object(D.jsx)(I,{condition:void 0!==e,children:Object(D.jsx)(I,{condition:e.name.includes(j)&&!r.includes(e),children:Object(D.jsx)("span",{className:"chat-settings-add-member-user",onClick:function(){return o((function(t){return[].concat(Object(W.a)(t),[e])}))},children:e.name})})})}))})}),Object(D.jsx)("hr",{}),Object(D.jsx)("div",{className:"chat-settings-text",children:"Color:"}),Object(D.jsxs)("div",{className:"flex chat-settings-default-colors",children:[Object(D.jsx)("div",{className:"settings-con-green ".concat("#A2DC68"===u?"chosen-color":""),onClick:function(){return d("#A2DC68")}}),Object(D.jsx)("div",{className:"settings-con-blue ".concat("#68DCC4"===u?"chosen-color":""),onClick:function(){return d("#68DCC4")}}),Object(D.jsx)("div",{className:"settings-con-purple ".concat("#DC68D0"===u?"chosen-color":""),onClick:function(){return d("#DC68D0")}}),Object(D.jsx)("div",{className:"settings-con-yellow ".concat("#D8DC68"===u?"chosen-color":""),onClick:function(){return d("#D8DC68")}})]}),Object(D.jsxs)("div",{className:"flex chat-settings-color-pick",children:[Object(D.jsx)("div",{className:"chat-settings-text",children:"Pick your own:"}),Object(D.jsx)("input",{className:"chat-settings-color-picker",type:"color",onChange:function(e){e.target.classList.add("chosen-color"),d(e.target.value)}})]}),Object(D.jsx)("hr",{}),Object(D.jsxs)("div",{className:"chat-settings-delete",onClick:Object(p.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new AbortController,e.next=3,h(t.signal,n._id);case 3:return e.abrupt("return",(function(){return t.abort()}));case 4:case"end":return e.stop()}}),e)}))),children:[Object(D.jsx)("span",{children:"X"})," Delete chatroom"]}),Object(D.jsx)("div",{className:"chat-settings-save",onClick:function(){return b(n._id)},children:"SAVE"})]})},re=Object(E.a)("div")(u||(u=Object(w.a)(["\n  background-image: url(../avatars/",");\n"])),(function(e){return e.img})),oe=Object(E.a)("span")(d||(d=Object(w.a)(["\n  background-color: ",";\n"])),(function(e){return e.color})),ie=Object(E.a)("section")(j||(j=Object(w.a)(["\n  background-color: ",";\n"])),(function(e){return e.color})),le=function(e){var t=e.ws,n=e.user,c=e.activeChatroom,s=e.setActiveChatroom,a=e.chatroomMessages,r=e.setChatroomMessages,o=e.newReaction,i=e.setNewReaction,l=e.membersTyping,u=e.usersOnline,d=e.setChatroomUpdated,j=e.setHomeCol3State,h=Object(m.useState)(!0),b=Object(C.a)(h,2),O=b[0],f=b[1],g=Object(m.useState)([]),v=Object(C.a)(g,2),N=v[0],w=v[1],k=Object(m.useState)(!1),S=Object(C.a)(k,2),_=S[0],y=S[1],M=Object(m.useState)([]),U=Object(C.a)(M,2),R=U[0],L=U[1],E=Object(m.useState)(""),T=Object(C.a)(E,2),F=T[0],P=T[1],J=Object(m.useState)(!0),H=Object(C.a)(J,2),W=H[0],z=H[1],q=Object(m.useState)(!1),V=Object(C.a)(q,2),B=V[0],X=V[1],G=Object(m.useState)(null),Z=Object(C.a)(G,2),K=(Z[0],Z[1],function(){var e=Object(p.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.next=3,A("/protected/get-chatroom-users/".concat(c._id),t);case 3:return n=e.sent,w(n.data),e.abrupt("return",Q(t));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Q=function(){var e=Object(p.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/get-chatroom-messages/".concat(c._id),t);case 2:n=e.sent,$(n.data),r(n.data),f(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){t&&1===t.readyState&&t.send(JSON.stringify({type:"message",detail:"message",sender:n,chatroom:c._id,reactions:[],text:F,time:ne()})),P(""),y(!1)},$=function(e){for(var t=[],n=0;n<e.length;n++)e[n+1]?(e[n].sender._id!==e[n+1].sender._id||e[n].sender._id===e[n+1].sender._id&&"userUpdate"===e[n+1].msgType)&&t.push(e[n]):t.push(e[n]);L(t)};return Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$(a);case 1:case"end":return e.stop()}}),e)}))),[a]),Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new AbortController,c&&z(!0),e.next=4,K(t.signal);case 4:return e.abrupt("return",(function(){return t.abort()}));case 5:case"end":return e.stop()}}),e)}))),[c]),Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_?(console.log("typing"),t&&1===t.readyState&&t.send(JSON.stringify({type:"isTyping",detail:!0,user:n,chatroom:c._id}))):t&&1===t.readyState&&t.send(JSON.stringify({type:"isTyping",detail:!1,user:n,chatroom:c._id}));case 1:case"end":return e.stop()}}),e)}))),[_]),O?Object(D.jsx)("h4",{children:"loading ..."}):Object(D.jsx)(D.Fragment,{children:Object(D.jsxs)("section",{onKeyPress:function(e){W&&function(e){"Enter"===e.key&&""!==F&&Y()}(e)},className:"flex height100 col3-chat-con ".concat(W?"chatstate":"settingsstate"),children:[Object(D.jsxs)("section",{className:"flex chat-con-top",children:[Object(D.jsxs)("div",{className:"flex top-userinfo",children:[Object(D.jsx)(ie,{color:c.theme,className:"userinfo-avatar"}),Object(D.jsx)("div",{className:"top-userinfo-chatroom-name",children:c.name})]}),Object(D.jsx)("div",{className:"flex top-settings",children:Object(D.jsxs)("div",{onClick:function(){z(!W)},className:"userinfo-avatar",children:[Object(D.jsx)(I,{condition:!W,children:Object(D.jsx)("i",{class:"fas fa-times"})}),Object(D.jsx)(I,{condition:W,children:Object(D.jsx)("i",{class:"fas fa-ellipsis-v"})})]})})]}),Object(D.jsx)(I,{condition:!W,children:Object(D.jsx)("section",{className:"chat-con-mid",children:Object(D.jsx)(ce,{ws:t,user:n,room:c,activeChatroom:c,setActiveChatroom:s,setChatroomUpdated:d,setChatState:z,setHomeCol3State:j})})}),Object(D.jsxs)(I,{condition:W,children:[Object(D.jsxs)("section",{className:"chat-con-mid",onScroll:function(e){return function(e){var t=e.scrollHeight-e.scrollTop===e.clientHeight;X(!t)}(e.target)},children:[Object(D.jsx)(I,{condition:B,children:Object(D.jsx)("div",{onClick:function(){document.querySelector(".chat-con-mid").scrollTop=document.querySelector(".chat-con-mid").scrollHeight},className:"arr-con",children:Object(D.jsx)("i",{class:"fas fa-arrow-down"})})}),Object(D.jsx)(I,{condition:a&&a.length>0,children:a.map((function(e,c){return Object(D.jsx)(ue,{m:e,user:n,chatroomUsers:N,msgAva:R,ws:t,newReaction:o,setNewReaction:i,usersOnline:u})}))})]}),Object(D.jsx)(I,{condition:l.length>0,children:l.map((function(e,t){return Object(D.jsxs)("div",{className:"flex istyping-con",children:[Object(D.jsxs)("div",{className:"flex",children:[Object(D.jsx)(re,{img:e.userAva,className:"istyping-avatar"}),e.userName]})," ",Object(D.jsx)(I,{condition:t===l.length-1,children:Object(D.jsx)("span",{children:" is typing..."})})]})}))}),Object(D.jsxs)("section",{className:"flex chat-con-bot",children:[Object(D.jsx)("div",{className:"con-bot-con-message",children:Object(D.jsx)("input",{placeholder:"write message",value:F,onChange:function(e){P(e.target.value),e.target.value.length>0&&!_?y(!0):e.target.value.length<1&&_&&y(!1)}})}),Object(D.jsx)("button",{className:"send-btn",type:"button",onClick:function(){""!==F&&Y()},children:Object(D.jsx)("i",{className:"fas fa-paper-plane"})})]})]})]})})},ue=function(e){var t=e.ws,n=e.m,c=e.user,s=(e.chatroomUsers,e.msgAva),a=e.newReaction,r=e.usersOnline,o=Object(m.useState)(null),i=Object(C.a)(o,2),l=i[0],u=i[1],d=Object(m.useState)([]),j=Object(C.a)(d,2),h=j[0],b=j[1],O=Object(m.useState)(!1),f=Object(C.a)(O,2),g=f[0],v=f[1],N=function(){var e=Object(p.a)(x.a.mark((function e(n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M("/protected/post-messagereaction",n);case 2:e.sent,t&&1===t.readyState&&t.send(JSON.stringify({type:"reaction",detail:"create",reacter:n.userId,reaction:n.reaction,chatroom:n.message.chatroom,messageId:n.message._id,message:n.message}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(p.a)(x.a.mark((function e(n){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new AbortController,e.next=3,A("/protected/delete-messagereaction/".concat(n.message._id,"/").concat(n.reactionId),c.signal);case 3:return e.sent,t&&1===t.readyState&&t.send(JSON.stringify({type:"reaction",detail:"delete",reactionId:n.reactionId,chatroom:n.message.chatroom,messageId:n.message._id})),e.abrupt("return",(function(){return c.abort()}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=4;break}b(n.reactions),e.next=12;break;case 4:if(a.messageId!==n._id){e.next=12;break}e.t0=a.detail,e.next="create"===e.t0?8:"delete"===e.t0?10:12;break;case 8:return b([].concat(Object(W.a)(h),[{reacter:a.reacter,reaction:a.reaction}])),e.abrupt("break",12);case 10:return b(h.filter((function(e){return e._id!==a.reactionId}))),e.abrupt("break",12);case 12:case"end":return e.stop()}}),e)}))),[a]),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(I,{condition:"userUpdate"===n.msgType,children:Object(D.jsxs)("div",{className:"flex userupdate-msg",children:[Object(D.jsx)(re,{img:n.sender.avatar,className:"userupdate-msg-ava"}),Object(D.jsx)("i",{children:n.text})]})}),Object(D.jsx)(I,{condition:"message"===n.msgType,children:Object(D.jsxs)("div",{className:"flex ".concat(n.sender._id===c._id?"message-right":"message-left"," ").concat(g?"active":""," ").concat(s.includes(n)?"":"noava"," ").concat(h.length>0?"reac":""),children:[Object(D.jsxs)("section",{className:"flex reactions-con",children:[Object(D.jsxs)(I,{condition:n.sender._id===c._id,children:[Object(D.jsx)(I,{condition:!g&&!h.some((function(e){return e.reacter===c._id})),children:Object(D.jsx)("div",{className:"reactions-con-showadd",onClick:function(){return v(!0)},children:Object(D.jsx)("i",{class:"fas fa-plus"})})}),Object(D.jsx)(I,{condition:g,children:Object(D.jsx)(de,{fetchPostMsgReaction:N,m:n,user:c,showReactions:g,setShowReactions:v})}),Object(D.jsx)("div",{className:"flex reactions-added-con",children:h.map((function(e){return console.log(e),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("i",{className:e.reaction}),Object(D.jsx)(I,{condition:e.reacter===c._id,children:Object(D.jsx)("span",{onClick:function(){w({message:n,reactionId:e._id})}})})]})}))})]}),Object(D.jsxs)("div",{className:"flex message-wrapper",onClick:function(){return u(l&&l===n?null:n)},children:[Object(D.jsx)(I,{condition:n.sender._id!==c._id&&s.includes(n),children:Object(D.jsx)(re,{img:n.sender.avatar,className:"message-avatar",children:Object(D.jsx)("div",{className:"onlinestatus-con",children:Object(D.jsx)(oe,{color:r.filter((function(e){return e._id===n.sender._id})).length>0?"#A2DC68":"#FF997D",className:"user-con-onlinestatus"})})})}),Object(D.jsx)("div",{className:"message-text",children:n.text}),Object(D.jsx)(I,{condition:n.sender._id===c._id&&s.includes(n),children:Object(D.jsx)(re,{img:n.sender.avatar,className:"message-avatar",children:Object(D.jsx)("div",{className:"onlinestatus-con",children:Object(D.jsx)(oe,{color:r.filter((function(e){return e._id===n.sender._id})).length>0?"#A2DC68":"#FF997D",className:"user-con-onlinestatus"})})})})]}),Object(D.jsxs)(I,{condition:n.sender._id!==c._id,children:[Object(D.jsx)(I,{condition:!g&&!h.some((function(e){return e.reacter===c._id})),children:Object(D.jsx)("div",{className:"reactions-con-showadd",onClick:function(){return v(!0)},children:Object(D.jsx)("i",{class:"fas fa-plus"})})}),Object(D.jsx)(I,{condition:g,children:Object(D.jsx)(de,{fetchPostMsgReaction:N,m:n,user:c,showReactions:g,setShowReactions:v})}),Object(D.jsx)("div",{className:"flex reactions-added-con",children:h.map((function(e){return console.log(e),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("i",{className:e.reaction}),Object(D.jsx)(I,{condition:e.reacter===c._id,children:Object(D.jsx)("span",{onClick:function(){w({message:n,reactionId:e._id})}})})]})}))})]})]}),Object(D.jsxs)(I,{condition:l===n,children:[Object(D.jsxs)("div",{className:"msg-details-name",children:["Sent by: ",n.sender.name]}),Object(D.jsx)("div",{className:"msg-details-time",children:n.time})]})]})})]})},de=function(e){var t=e.fetchPostMsgReaction,n=e.m,c=e.user,s=(e.showReactions,e.setShowReactions);return Object(D.jsxs)("div",{className:"flex reactions-add-con",children:[Object(D.jsx)("div",{onClick:function(){t({reaction:"fas fa-thumbs-up",message:n,userId:c._id}),s(!1)},children:Object(D.jsx)("i",{className:"fas fa-thumbs-up"})}),Object(D.jsx)("div",{onClick:function(){t({reaction:"far fa-grin",message:n,userId:c._id}),s(!1)},children:Object(D.jsx)("i",{className:"far fa-grin"})}),Object(D.jsx)("div",{onClick:function(){t({reaction:"far fa-grin-squint-tears",message:n,userId:c._id}),s(!1)},children:Object(D.jsx)("i",{className:"far fa-grin-squint-tears"})}),Object(D.jsx)("div",{onClick:function(){t({reaction:"far fa-angry",message:n,userId:c._id}),s(!1)},children:Object(D.jsx)("i",{className:"far fa-angry"})}),Object(D.jsx)("div",{onClick:function(){t({reaction:"far fa-frown",message:n,userId:c._id}),s(!1)},children:Object(D.jsx)("i",{className:"far fa-frown"})}),Object(D.jsx)("div",{onClick:function(){t({reaction:"fas fa-thumbs-down",message:n,userId:c._id}),s(!1)},children:Object(D.jsx)("i",{className:"fas fa-thumbs-down"})}),Object(D.jsx)("div",{onClick:function(){return s(!1)},children:Object(D.jsx)("i",{className:"fas fa-times"})})]})},je=function(e){e.homeCol3State;var t=e.user,n=e.ws,c=(e.setChatroomUpdated,Object(m.useState)(!0)),s=Object(C.a)(c,2),a=(s[0],s[1]),r=Object(m.useState)(""),o=Object(C.a)(r,2),i=o[0],l=o[1],u=Object(m.useState)("#FA0000"),d=Object(C.a)(u,2),j=d[0],h=d[1],b=Object(m.useState)([t._id]),O=Object(C.a)(b,2),f=O[0],g=O[1],v=Object(m.useState)([t]),N=Object(C.a)(v,2),w=N[0],k=N[1],S=Object(m.useState)([]),_=Object(C.a)(S,2),y=_[0],U=_[1],R=Object(m.useState)(""),L=Object(C.a)(R,2),E=L[0],T=L[1],F=Object(m.useState)(null),P=Object(C.a)(F,2),J=P[0],H=P[1],z=function(){var e=Object(p.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/get-all-users",t);case 2:n=e.sent,U(n.data),a(!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(p.a)(x.a.mark((function e(){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M("/protected/create-chatroom",{name:i,admins:f,members:w,theme:j});case 2:(c=e.sent).success&&(H(c.message),l(""),h("#FA0000"),k([t]),g([t._id]),U([]),T(""),n.send(JSON.stringify({type:"chatroomCreate",detail:"chatroomCreate"})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(m.useEffect)((function(){J&&setTimeout((function(){return H(null)}),4e3)}),[J]),Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new AbortController,e.next=3,z(t.signal);case 3:return e.abrupt("return",(function(){return t.abort()}));case 4:case"end":return e.stop()}}),e)}))),[]),Object(D.jsx)("section",{className:"flex height100 col3-chat-con",children:Object(D.jsxs)("section",{className:"dashboard-con-create-con",children:[Object(D.jsx)("div",{className:"flex create-con-top",children:Object(D.jsx)("h3",{children:"Create chatroom"})}),Object(D.jsxs)("div",{className:"create-con-name",children:[Object(D.jsx)("label",{htmlFor:"",className:"create-con-text",children:"Name:"}),Object(D.jsx)("input",{className:"create-con-input-text",type:"text",name:"name",value:i,onChange:function(e){return l(e.target.value)}})]}),Object(D.jsxs)("div",{className:"flex create-con-theme-color",children:[Object(D.jsx)("input",{type:"text",name:"theme",value:j,hidden:!0}),Object(D.jsx)("div",{className:"create-con-text",children:"Color:"}),Object(D.jsxs)("div",{className:"flex create-con-default-colors",children:[Object(D.jsx)("div",{className:"create-con-green",onClick:function(){return h("#A2DC68")}}),Object(D.jsx)("div",{className:"create-con-blue",onClick:function(){return h("#68DCC4")}}),Object(D.jsx)("div",{className:"create-con-purple",onClick:function(){return h("#DC68D0")}}),Object(D.jsx)("div",{className:"create-con-yellow",onClick:function(){return h("#D8DC68")}})]})]}),Object(D.jsxs)("div",{className:"flex create-con-pick-color",children:[Object(D.jsx)("div",{className:"create-con-text",children:"Pick your own:"}),Object(D.jsx)("input",{className:"create-con-color-picker",type:"color",onChange:function(e){return h(e.target.value)}})]}),Object(D.jsx)("div",{className:"chat-settings-text",children:"Members:"}),Object(D.jsx)("div",{className:"flex chat-settings-members-container",children:w.map((function(e,n){return Object(D.jsxs)("div",{className:"amem-con",children:[Object(D.jsxs)("div",{className:"flex chat-settings-current-members",children:[Object(D.jsxs)("div",{className:"current-members",children:[e.name," "]}),Object(D.jsx)(I,{condition:f.includes(e._id),children:Object(D.jsx)("span",{children:"A"})})]}),Object(D.jsxs)(I,{condition:e._id!==t._id,children:[Object(D.jsx)(I,{condition:!f.includes(e._id),children:Object(D.jsx)("div",{className:"chat-settings-make-admin",onClick:function(){return g((function(t){return[].concat(Object(W.a)(t),[e._id])}))},children:"adminize"})}),Object(D.jsx)("div",{className:"chat-settings-kick",onClick:function(){var t=w.filter((function(t){return t._id!==e._id}));k(t);var n=y;n.includes(e)||n.push(e),U(n);var c=f.filter((function(t){return t!==e._id}));g(c)},children:"kick"})]})]})}))}),Object(D.jsxs)("div",{className:"create-con-add-user",children:[Object(D.jsx)("label",{className:"create-con-text",htmlFor:"",children:"Add members:"}),Object(D.jsx)("input",{className:"create-con-input-text",type:"text",placeholder:"search user",value:E,onChange:function(e){return T(e.target.value)}}),Object(D.jsx)("div",{className:"flex add-user-user-container",children:Object(D.jsx)(I,{condition:""!==E,children:y.map((function(e){return Object(D.jsx)(I,{condition:e.name.includes(E)&&!w.includes(e)&&e._id!==t._id,children:Object(D.jsx)("span",{className:"chat-settings-add-member-user",onClick:function(){return k((function(t){return[].concat(Object(W.a)(t),[e])}))},children:e.name})})}))})})]}),Object(D.jsx)("button",{className:"create-con-button-create",onClick:function(){return q()},children:"CREATE"}),Object(D.jsx)(I,{condition:J,children:Object(D.jsxs)("div",{children:[J," ",Object(D.jsx)("i",{className:"fas fa-check"})]})})]})})},me=function(e){var t=e.ws,n=e.user,c=e.userChatrooms,s=e.notUserChatrooms,a=e.usersOnline,r=e.setUsersOnline,o=e.setChatroomUpdated,i=Object(m.useState)(window.innerWidth),l=Object(C.a)(i,2),u=l[0],d=l[1],j=Object(m.useState)("createChatroom"),h=Object(C.a)(j,2),b=h[0],O=h[1],f=Object(m.useState)(null),g=Object(C.a)(f,2),v=g[0],N=g[1],w=Object(m.useState)(null),k=Object(C.a)(w,2),S=k[0],y=k[1],A=Object(m.useState)(!1),M=Object(C.a)(A,2),U=M[0],L=M[1],E=Object(m.useState)([]),T=Object(C.a)(E,2),F=T[0],P=T[1],J=Object(m.useState)(null),H=Object(C.a)(J,2),z=H[0],q=H[1],V=Object(m.useState)([]),B=Object(C.a)(V,2),X=B[0],G=B[1],Z=Object(m.useState)(!0),K=Object(C.a)(Z,2),Q=K[0],Y=K[1];return Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(t.onmessage=function(){var e=Object(p.a)(x.a.mark((function e(s){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=JSON.parse(s.data),console.log(a),e.t0=a.type,e.next="usersOnline"===e.t0?5:"isTyping"===e.t0?7:"reaction"===e.t0?9:"message"===e.t0?11:"chatroomUpdate"===e.t0?20:"chatroomCreate"===e.t0?30:"chatroomDelete"===e.t0?32:35;break;case 5:return r(a.users),e.abrupt("break",35);case 7:return a.chatroom===U._id&&a.user._id!==n._id&&(a.detail?(G([].concat(Object(W.a)(X),[{userName:a.user.name,userAva:a.user.avatar,userId:a.user._id}])),document.querySelector(".chat-con-mid").scrollTop=document.querySelector(".chat-con-mid").scrollHeight):G(X.filter((function(e){return e.userId!==a.user._id})))),e.abrupt("break",35);case 9:return a.chatroom===U._id&&q(a),e.abrupt("break",35);case 11:if(!U||a.chatroom!==U._id){e.next=18;break}if("userLeft"!==a.detail||n._id!==a.sender._id){e.next=16;break}return e.abrupt("return");case 16:P([].concat(Object(W.a)(F),[a])),document.querySelector(".chat-con-mid").scrollTop=document.querySelector(".chat-con-mid").scrollHeight;case 18:return c.filter((function(e){return e._id===a.chatroom})).length>0&&(a.chatroom!==U._id&&(console.log("score"),y({chatroom:a.chatroom})),N({chatroom:a.chatroom})),e.abrupt("break",35);case 20:if(!c.filter((function(e){return e._id===a.chatroomId}))[0]){e.next=29;break}e.t1=a.detail,e.next="userJoined"===e.t1?25:"userLeft"===e.t1?27:29;break;case 25:return t.send(JSON.stringify({type:"message",detail:"userJoined",sender:a.user,chatroom:a.chatroomId,reactions:[],text:"".concat(a.user.name," has joined the chat!"),time:ne()})),e.abrupt("break",29);case 27:return a.user._id!==n._id&&t.send(JSON.stringify({type:"message",detail:"userLeft",sender:a.user,chatroom:a.chatroomId,reactions:[],text:"".concat(a.user.name," has left the chat!"),time:ne()})),e.abrupt("break",29);case 29:return e.abrupt("break",35);case 30:return o(!0),e.abrupt("break",35);case 32:return o(!0),U&&a.chatroomId===U._id&&(O("createChatroom"),L(!1)),e.abrupt("break",35);case 35:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),[t.onmessage]),Object(m.useEffect)((function(){var e=window.addEventListener("resize",(function(){return d(window.innerWidth)}));return window.removeEventListener("resize",e)}),[u]),Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)(_.a,{lg:{span:4,order:2},md:{span:4,order:2},xs:{span:12,order:2},className:"dashboard-con-col2",children:[Object(D.jsx)(I,{condition:u<R&&Q||u>R,children:Object(D.jsx)(ee,{ws:t,user:n,userChatrooms:c,notUserChatrooms:s,activeChatroom:U,setActiveChatroom:L,homeCol3State:b,setHomeCol3State:O,chatroomLastMessage:v,setChatroomLastMessage:N,chatroomUnreadMsgs:S,setChatroomUnreadMsgs:y,setChatroomUpdated:o,usersOnline:a,setMobileCol2Chatrooms:Y})}),Object(D.jsxs)(I,{condition:u<R&&!Q,children:[Object(D.jsx)(I,{condition:"chat"===b,children:Object(D.jsx)(le,{ws:t,user:n,activeChatroom:U,setActiveChatroom:L,chatroomMessages:F,setChatroomMessages:P,newReaction:z,setNewReaction:q,membersTyping:X,usersOnline:a,setChatroomUpdated:o,setHomeCol3State:O})}),Object(D.jsx)(I,{condition:"createChatroom"===b,children:Object(D.jsx)(je,{ws:t,user:n,homeCol3State:b})})]})]}),Object(D.jsx)(I,{condition:u>R,children:Object(D.jsxs)(_.a,{lg:{span:6,order:3},md:{span:6,order:3},xs:{span:12,order:3},className:"dashboard-con-col3",children:[Object(D.jsx)(I,{condition:"chat"===b,children:Object(D.jsx)(le,{ws:t,user:n,activeChatroom:U,setActiveChatroom:L,chatroomMessages:F,setChatroomMessages:P,newReaction:z,setNewReaction:q,membersTyping:X,usersOnline:a,setChatroomUpdated:o,setHomeCol3State:O})}),Object(D.jsx)(I,{condition:"createChatroom"===b,children:Object(D.jsx)(je,{ws:t,user:n,homeCol3State:b,setChatroomUpdated:o})})]})})]})},he=function(){var e=Object(m.useState)(!0),t=Object(C.a)(e,2),n=t[0],c=t[1],s=Object(m.useState)(window.innerWidth),a=Object(C.a)(s,2),r=a[0],o=a[1],i=Object(m.useState)(null),l=Object(C.a)(i,2),u=l[0],d=l[1],j=Object(m.useState)(!1),h=Object(C.a)(j,2),b=h[0],O=h[1],f=Object(m.useState)(!1),g=Object(C.a)(f,2),v=g[0],N=g[1],w=Object(m.useState)(null),y=Object(C.a)(w,2),M=y[0],U=y[1],L=Object(m.useState)(null),E=Object(C.a)(L,2),T=E[0],F=E[1],J=Object(m.useState)(null),W=Object(C.a)(J,2),z=W[0],q=W[1],V=Object(m.useState)([]),B=Object(C.a)(V,2),X=B[0],G=B[1],Z=Object(m.useState)("home"),Q=Object(C.a)(Z,2),Y=Q[0],$=Q[1],ee=function(){var e=Object(p.a)(x.a.mark((function e(t){var n,s,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/get-user",t);case 2:return n=e.sent,U(n.data),s=n.data._id,e.next=7,A("/protected/get-all-chatrooms",t);case 7:a=e.sent,F(a.data.filter((function(e){return e.members.includes(s)})).sort((function(e,t){return t.starmarked.includes(s)-e.starmarked.includes(s)}))),q(a.data.filter((function(e){return!e.members.includes(s)}))),c(!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(p.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/get-user",t);case 2:n=e.sent,U(n.data),O(!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(p.a)(x.a.mark((function e(t,n){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/protected/get-all-chatrooms",t);case 2:c=e.sent,F(c.data.filter((function(e){return e.members.includes(n)})).sort((function(e,t){return t.starmarked.includes(n)-e.starmarked.includes(n)}))),q(c.data.filter((function(e){return!e.members.includes(n)}))),N(!1);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=5;break}return t=new AbortController,e.next=4,te(t.signal);case 4:return e.abrupt("return",(function(){return t.abort()}));case 5:case"end":return e.stop()}}),e)}))),[b]),Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v){e.next=5;break}return t=new AbortController,e.next=4,ne(t.signal,M._id);case 4:return e.abrupt("return",(function(){return t.abort()}));case 5:case"end":return e.stop()}}),e)}))),[v]),Object(m.useEffect)(Object(p.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new AbortController,e.next=3,ee(t.signal);case 3:return e.abrupt("return",(function(){return t.abort()}));case 4:case"end":return e.stop()}}),e)}))),[]),Object(m.useEffect)((function(){var e=window.addEventListener("resize",(function(){return o(window.innerWidth)}));return window.removeEventListener("resize",e)}),[r]),Object(m.useEffect)((function(){return u||n||d(new WebSocket("wss://chatwskul.herokuapp.com?userId="+M._id)),u&&(u.onopen=function(){console.log("WebSocket Connected")},u.onclose=function(){console.log("WebSocket Gone")},u.onmessage=function(){var e=Object(p.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=JSON.parse(t.data),console.log(n),"ah ah ah stay alive!"!==n){e.next=4;break}return e.abrupt("return");case 4:"usersOnline"===n.type&&(console.log("online"),console.log(n),G(n.users));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){u&&u.close()}}),[u,n]),!n&&M&&u?Object(D.jsx)(k.a,{className:"page page-dashboard ".concat(r<R?"page-dashboard-mobile":"page-dashboard-desktop"),children:Object(D.jsxs)(S.a,{className:"dashboard-con",children:[Object(D.jsxs)(_.a,{lg:{span:2,order:1},md:{span:2,order:1},xs:{span:12,order:1},className:"flex dashboard-con-col1",children:[Object(D.jsx)(H,{user:M}),Object(D.jsx)(P,{navState:Y,setNavState:$})]}),Object(D.jsx)(I,{condition:"home"===Y,children:Object(D.jsx)(me,{ws:u,user:M,userChatrooms:T,notUserChatrooms:z,usersOnline:X,setUsersOnline:G,setChatroomUpdated:N})}),Object(D.jsx)(I,{condition:"settings"===Y,children:Object(D.jsx)(K,{ws:u,user:M,userChatrooms:T,setUserUpdated:O,setChatroomUpdated:N})})]})}):Object(D.jsx)("h2",{className:"",children:"Loading..."})},be=(n(52),n(53),n(54),function(){var e=Object(p.a)(x.a.mark((function e(t,n,c){var s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("/logged-in");case 2:if(s=e.sent,void 0!==t.meta.auth){e.next=5;break}return e.abrupt("return",c());case 5:if(!t.meta.auth||s.data){e.next=7;break}return e.abrupt("return",c.redirect("/"));case 7:if(t.meta.auth||!s.data){e.next=9;break}return e.abrupt("return",c.redirect("/dashboard"));case 9:return e.abrupt("return",c());case 10:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}()),Oe=function(){return Object(D.jsx)("p",{children:"Loading..."})},fe=function(){return Object(D.jsx)("p",{children:"Not Found"})};var xe=function(){return Object(D.jsx)("div",{className:"App",children:Object(D.jsx)(g.a,{children:Object(D.jsx)(N.a,{guards:[be],loading:Oe,error:fe,children:Object(D.jsxs)(v.d,{children:[Object(D.jsx)(N.b,{path:"/",exact:!0,component:F,meta:{auth:!1}}),Object(D.jsx)(N.b,{path:"/dashboard",exact:!0,component:he,meta:{auth:!0}}),Object(D.jsx)(N.b,{path:"*",component:fe})]})})})})},pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,59)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),s(e),a(e),r(e)}))};O.a.render(Object(D.jsx)(h.a.StrictMode,{children:Object(D.jsx)(xe,{})}),document.getElementById("root")),pe()}},[[55,1,2]]]);
//# sourceMappingURL=main.c3160390.chunk.js.map